
<process id="general"
         xmlns="werkflow:fundamental"
         xmlns:wfjava="werkflow:java"
         xmlns:wfjelly="werkflow:jelly"
         xmlns:j="jelly:core">

  <message-type id="normal.msg">
    <wfjava:selector type="com.werken.werkflow.SimpleMessage"
                     filter="${message.type == 'normal'}"/>
  </message-type>

  <message-type id="init.msg">
    <wfjava:selector type="com.werken.werkflow.SimpleMessage"
                     filter="${message.type == 'init'}"/>
  </message-type>

  <message-initiator id="bob" 
                     type="init.msg"/>

  <place id="in">
    <documentation>the in place</documentation>
  </place>

  <place id="middle">
    <documentation>the middle place</documentation>
  </place>

  <place id="out">
    <documentation>the out place</documentation>
  </place>

  <transition id="transition one" type="or">
    <documentation>the 1st transition</documentation>
    <input from="in"/>
    <output to="middle"/>
    
    <task>
      <action>
        action 1
        bob = ${bob}
        <j:set var="bob" value="mcstrachan"/>
      </action>
    </task>
  </transition>

  <transition id="transition two" type="and">
    <documentation>the 2nd transition</documentation>
    <input from="middle"/>
    <output to="out"/>

    <message id="myMsg" type="normal.msg">
      <wfjelly:correlator test="${myMsg.payload == bob}"/>
    </message>>

    <task>
      <action>
        action 2
        bob == ${bob}
        myMsg == ${myMsg.type} : ${myMsg.payload} 
      </action>
    </task>
  </transition>

</process>
