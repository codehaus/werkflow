
<project default="java:jar"
         xmlns:j="jelly:core">

  <postGoal name="clover">
    <copy tofile="${basedir}/target/docs/clover/style.css"
          file="${basedir}/xdocs/stylesheets/clover-style.css"
          overwrite="true"/>
    <copy tofile="${basedir}/target/docs/clover/pkgs-summary"
          file="${basedir}/target/docs/clover/pkgs-summary.html"/>
  </postGoal>

  <preGoal name="site:generate">
    <attainGoal name="clover"/>
  </preGoal>

  <goal name="werkflow:compile-examples" prereqs="java:jar">
    <echo>compiling examples</echo>
    <mkdir dir="${werkflow.examples.dest.dir}"/>
    <javac srcdir="${werkflow.examples.src.dir}"
           destdir="${werkflow.examples.dest.dir}"
           debug="on">
      <classpath>
        <path refid="maven.dependency.classpath"/>
        <path location="target/${maven.final.name}.jar"/>
      </classpath>
    </javac>
    <copy toDir="${werkflow.examples.dest.dir}">
      <fileset dir="${werkflow.examples.src.dir}">
        <include name="**/*.werk"/>
        <include name="**/*.xml"/>
        <include name="**/*.properties"/>
      </fileset>
    </copy>
  </goal>

  <goal name="werkflow:example-po"
        prereqs="werkflow:compile-examples">
    <echo>running po example</echo>
    <java classname="po.PurchaseOrderExample" fork="true"> 
      <classpath>
        <path location="${werkflow.examples.dest.dir}"/>
        <path location="target/${maven.final.name}.jar"/>
        <path refid="maven.dependency.classpath"/>
      </classpath>
    </java>
  </goal>

  <goal name="getting-started" prereqs="werkflow:example-po"/>

  <goal name="rhill">

    <j:set var="wp" value="${org.apache.commons.jelly.werkz.Project}"/>

    <j:forEach var="goal" items="${wp.goals}">
      <echo>  goal ${goal.name}</echo>
    </j:forEach>
   
  </goal>
</project>
